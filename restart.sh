#!/bin/bash

echo "Перезапуск микросервиса..."

# Остановка микросервиса
echo "1. Остановка микросервиса..."
docker-compose down

# Проверка успешной остановки
if [ $? -ne 0 ]; then
    echo "Ошибка при остановке микросервиса. Проверьте логи для получения дополнительной информации."
    exit 1
fi

# Запуск микросервиса
echo "2. Запуск микросервиса..."
docker-compose up -d --build

# Проверка успешного запуска
if [ $? -eq 0 ]; then
    echo "Микросервис успешно перезапущен и доступен по адресу http://localhost:8000"
    echo "Документация API доступна по адресу http://localhost:8000/docs"
else
    echo "Ошибка при запуске микросервиса. Проверьте логи для получения дополнительной информации."
    exit 1
fi

# Вывод логов для проверки
echo "Вывод логов микросервиса:"
docker-compose logs --tail=30 app 